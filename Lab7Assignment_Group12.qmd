---
title: "Lab7Assignment Group12"
format: 
  html:
    embed-resources: true
editor: visual
authors: "s132347(Sofie Emilie Hagelund), s253710(Henrique Gomes), s253689(Paula Meerjanssen), s252750(Shuyue Zhang), s253719(Eszter Hudra)"
---

## Load Libraries

```{r}
#| message: false  

library(tidyverse) 
library(broom)  
library(cowplot)
```

## Load Data

```{r}
biopsy <- read_csv(
  "https://wilkelab.org/classes/SDS348/data_sets/biopsy.csv",
  show_col_types = FALSE)
```

## PCA

```{r}
pca_fit <- biopsy %>% 
  select(where(is.numeric)) %>% 
  scale() %>% 
  prcomp() 
```

## Visualization

Below is a graph for visualization.

The graph contains sample data showing separation between benign (blue) and malignant (orange) outcomes. Each point represents one sample, positioned according to its scores on the first two principal components (PC1 and PC2). Clustering of data clearly indicates that the PCA captures meaningful variation related to the outcome type.

```{r}
pca_fit %>% 
  augment(biopsy) %>% 
  ggplot(aes(
    x = .fittedPC1, 
    y = .fittedPC2,
    color = outcome)) +
  geom_point(
    alpha = 0.7, 
    size = 1.0) +
  theme_minimal() +
  theme(axis.line = element_line())
  
  
```

```{r}
pca_fit %>%
  tidy(matrix = "rotation")
```

```{r}
arrow_style <- arrow(
  angle = 20, ends = "first", type = "closed", length = grid::unit(8, "pt")
)

pca_fit %>%
  tidy(matrix = "rotation") %>%
  pivot_wider(names_from = "PC", names_prefix = "PC", values_from = "value") %>%
  ggplot(aes(PC1, PC2)) +
  geom_segment(xend = 0, yend = 0, arrow = arrow_style) +
  geom_text(
    aes(label = column),
    hjust = 1, nudge_x = -0.02, 
    color = "#904C2F"
  ) +
  xlim(-1.25, .5) + ylim(-.5, 1) +
  coord_fixed() + 
  theme_minimal_grid(12)
```
